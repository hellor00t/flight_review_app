{"ast":null,"code":"/*\n * Licensed to Elasticsearch B.V. under one or more contributor\n * license agreements. See the NOTICE file distributed with\n * this work for additional information regarding copyright\n * ownership. Elasticsearch B.V. licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { printIso8601 } from './date_format';\nimport { isDateValue } from './date_value';\nimport { AST, Operator } from './ast';\nimport { isArray, isDateLike, isString, isBoolean, isNumber } from '../../../services/predicate';\n\nvar emitMatch = function emitMatch(match) {\n  if (!match) {\n    return '';\n  }\n\n  return AST.Match.isMust(match) ? '+' : '-';\n};\n\nvar escapeValue = function escapeValue(value) {\n  if (typeof value === 'string') {\n    return value.replace(/([\\\\\"])/g, '\\\\$1');\n  }\n\n  return value;\n};\n\nvar emitFieldDateLikeClause = function emitFieldDateLikeClause(field, value, operator, match) {\n  var matchOp = emitMatch(match);\n\n  switch (operator) {\n    case Operator.EQ:\n      return \"\".concat(matchOp).concat(field, \":\").concat(printIso8601(value));\n\n    case Operator.GT:\n      return \"\".concat(matchOp).concat(field, \":>\").concat(printIso8601(value));\n\n    case Operator.GTE:\n      return \"\".concat(matchOp).concat(field, \":>=\").concat(printIso8601(value));\n\n    case Operator.LT:\n      return \"\".concat(matchOp).concat(field, \":<\").concat(printIso8601(value));\n\n    case Operator.LTE:\n      return \"\".concat(matchOp).concat(field, \":<=\").concat(printIso8601(value));\n\n    default:\n      throw new Error(\"unknown operator [\".concat(operator, \"]\"));\n  }\n};\n\nvar emitFieldDateValueClause = function emitFieldDateValueClause(field, value, operator, match) {\n  var matchOp = emitMatch(match);\n  var granularity = value.granularity,\n      resolve = value.resolve;\n  var date = resolve();\n\n  if (granularity) {\n    switch (operator) {\n      case Operator.EQ:\n        var gte = granularity.iso8601(granularity.start(date));\n        var lt = granularity.iso8601(granularity.startOfNext(date));\n        return \"\".concat(matchOp).concat(field, \":(>=\").concat(gte, \" AND <\").concat(lt, \")\");\n\n      case Operator.GT:\n        return \"\".concat(matchOp).concat(field, \":>=\").concat(granularity.iso8601(granularity.startOfNext(date)));\n\n      case Operator.GTE:\n        return \"\".concat(matchOp).concat(field, \":>=\").concat(granularity.iso8601(granularity.start(date)));\n\n      case Operator.LT:\n        return \"\".concat(matchOp).concat(field, \":<\").concat(granularity.iso8601(granularity.start(date)));\n\n      case Operator.LTE:\n        return \"\".concat(matchOp).concat(field, \":<\").concat(granularity.iso8601(granularity.startOfNext(date)));\n\n      default:\n        throw new Error(\"unknown operator [\".concat(operator, \"]\"));\n    }\n  }\n\n  return emitFieldDateLikeClause(field, date, operator, match);\n};\n\nvar emitFieldNumericClause = function emitFieldNumericClause(field, value, operator, match) {\n  var matchOp = emitMatch(match);\n\n  switch (operator) {\n    case Operator.EQ:\n      return \"\".concat(matchOp).concat(field, \":\").concat(value);\n\n    case Operator.GT:\n      return \"\".concat(matchOp).concat(field, \":>\").concat(value);\n\n    case Operator.GTE:\n      return \"\".concat(matchOp).concat(field, \":>=\").concat(value);\n\n    case Operator.LT:\n      return \"\".concat(matchOp).concat(field, \":<\").concat(value);\n\n    case Operator.LTE:\n      return \"\".concat(matchOp).concat(field, \":<=\").concat(value);\n\n    default:\n      throw new Error(\"unknown operator [\".concat(operator, \"]\"));\n  }\n};\n\nvar emitFieldStringClause = function emitFieldStringClause(field, value, match) {\n  var matchOp = emitMatch(match);\n\n  if (value.match(/\\s/)) {\n    return \"\".concat(matchOp).concat(field, \":\\\"\").concat(escapeValue(value), \"\\\"\");\n  }\n\n  return \"\".concat(matchOp).concat(field, \":\").concat(escapeValue(value));\n};\n\nvar emitFieldBooleanClause = function emitFieldBooleanClause(field, value, match) {\n  var matchOp = emitMatch(match);\n  return \"\".concat(matchOp).concat(field, \":\").concat(value);\n};\n\nvar emitFieldSingleValueClause = function emitFieldSingleValueClause(field, value, operator, match) {\n  if (isDateValue(value)) {\n    return emitFieldDateValueClause(field, value, operator, match);\n  }\n\n  if (isDateLike(value)) {\n    return emitFieldDateLikeClause(field, value, operator, match);\n  }\n\n  if (isString(value)) {\n    return emitFieldStringClause(field, value, match);\n  }\n\n  if (isNumber(value)) {\n    return emitFieldNumericClause(field, value, operator, match);\n  }\n\n  if (isBoolean(value)) {\n    return emitFieldBooleanClause(field, value, match);\n  }\n\n  throw new Error(\"unknown type of field value [\".concat(value, \"]\"));\n};\n\nvar emitFieldClause = function emitFieldClause(clause, isGroupMember) {\n  var field = clause.field,\n      value = clause.value,\n      operator = clause.operator;\n  var match = clause.match;\n\n  if (isGroupMember && AST.Match.isMust(match)) {\n    match = undefined;\n  }\n\n  if (!isArray(value)) {\n    return emitFieldSingleValueClause(field, value, operator, match);\n  }\n\n  var matchOp = emitMatch(match);\n  var clauses = value.map(function (v) {\n    return emitFieldSingleValueClause(field, v, operator);\n  }).join(' OR ');\n  return \"\".concat(matchOp, \"(\").concat(clauses, \")\");\n};\n\nvar emitTermClause = function emitTermClause(clause, isGroupMember) {\n  var value = clause.value;\n  var match = clause.match;\n\n  if (isGroupMember && AST.Match.isMust(match)) {\n    match = undefined;\n  }\n\n  var matchOp = emitMatch(match);\n  return \"\".concat(matchOp).concat(escapeValue(value));\n};\n\nvar emitIsClause = function emitIsClause(clause, isGroupMember) {\n  var flag = clause.flag,\n      match = clause.match;\n  var matchOp = isGroupMember ? '' : '+';\n  var flagValue = AST.Match.isMust(match);\n  return \"\".concat(matchOp).concat(flag, \":\").concat(flagValue);\n};\n\nvar emitGroupClause = function emitGroupClause(clause) {\n  var value = clause.value;\n  var formattedValues = value.map(function (clause) {\n    return emitClause(clause, true);\n  });\n  return \"+(\".concat(formattedValues.join(' '), \")\");\n};\n\nfunction emitClause(clause) {\n  var isGroupMember = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n  if (AST.Field.isInstance(clause)) {\n    return emitFieldClause(clause, isGroupMember);\n  }\n\n  if (AST.Term.isInstance(clause)) {\n    return emitTermClause(clause, isGroupMember);\n  }\n\n  if (AST.Is.isInstance(clause)) {\n    return emitIsClause(clause, isGroupMember);\n  }\n\n  if (AST.Group.isInstance(clause)) {\n    return emitGroupClause(clause);\n  }\n\n  throw new Error(\"unknown clause type [\".concat(JSON.stringify(clause), \"]\"));\n}\n\nexport var astToEsQueryString = function astToEsQueryString(ast) {\n  if (ast.clauses.length === 0) {\n    return '*';\n  }\n\n  return ast.clauses.map(function (clause) {\n    return emitClause(clause);\n  }).join(' ');\n};","map":{"version":3,"sources":["/Users/scott/Projects/flight_review_project/node_modules/@elastic/eui/es/components/search_bar/query/ast_to_es_query_string.js"],"names":["printIso8601","isDateValue","AST","Operator","isArray","isDateLike","isString","isBoolean","isNumber","emitMatch","match","Match","isMust","escapeValue","value","replace","emitFieldDateLikeClause","field","operator","matchOp","EQ","concat","GT","GTE","LT","LTE","Error","emitFieldDateValueClause","granularity","resolve","date","gte","iso8601","start","lt","startOfNext","emitFieldNumericClause","emitFieldStringClause","emitFieldBooleanClause","emitFieldSingleValueClause","emitFieldClause","clause","isGroupMember","undefined","clauses","map","v","join","emitTermClause","emitIsClause","flag","flagValue","emitGroupClause","formattedValues","emitClause","arguments","length","Field","isInstance","Term","Is","Group","JSON","stringify","astToEsQueryString","ast"],"mappings":"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","sourcesContent":["/*\n * Licensed to Elasticsearch B.V. under one or more contributor\n * license agreements. See the NOTICE file distributed with\n * this work for additional information regarding copyright\n * ownership. Elasticsearch B.V. licenses this file to you under\n * the Apache License, Version 2.0 (the \"License\"); you may\n * not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { printIso8601 } from './date_format';\nimport { isDateValue } from './date_value';\nimport { AST, Operator } from './ast';\nimport { isArray, isDateLike, isString, isBoolean, isNumber } from '../../../services/predicate';\n\nvar emitMatch = function emitMatch(match) {\n  if (!match) {\n    return '';\n  }\n\n  return AST.Match.isMust(match) ? '+' : '-';\n};\n\nvar escapeValue = function escapeValue(value) {\n  if (typeof value === 'string') {\n    return value.replace(/([\\\\\"])/g, '\\\\$1');\n  }\n\n  return value;\n};\n\nvar emitFieldDateLikeClause = function emitFieldDateLikeClause(field, value, operator, match) {\n  var matchOp = emitMatch(match);\n\n  switch (operator) {\n    case Operator.EQ:\n      return \"\".concat(matchOp).concat(field, \":\").concat(printIso8601(value));\n\n    case Operator.GT:\n      return \"\".concat(matchOp).concat(field, \":>\").concat(printIso8601(value));\n\n    case Operator.GTE:\n      return \"\".concat(matchOp).concat(field, \":>=\").concat(printIso8601(value));\n\n    case Operator.LT:\n      return \"\".concat(matchOp).concat(field, \":<\").concat(printIso8601(value));\n\n    case Operator.LTE:\n      return \"\".concat(matchOp).concat(field, \":<=\").concat(printIso8601(value));\n\n    default:\n      throw new Error(\"unknown operator [\".concat(operator, \"]\"));\n  }\n};\n\nvar emitFieldDateValueClause = function emitFieldDateValueClause(field, value, operator, match) {\n  var matchOp = emitMatch(match);\n  var granularity = value.granularity,\n      resolve = value.resolve;\n  var date = resolve();\n\n  if (granularity) {\n    switch (operator) {\n      case Operator.EQ:\n        var gte = granularity.iso8601(granularity.start(date));\n        var lt = granularity.iso8601(granularity.startOfNext(date));\n        return \"\".concat(matchOp).concat(field, \":(>=\").concat(gte, \" AND <\").concat(lt, \")\");\n\n      case Operator.GT:\n        return \"\".concat(matchOp).concat(field, \":>=\").concat(granularity.iso8601(granularity.startOfNext(date)));\n\n      case Operator.GTE:\n        return \"\".concat(matchOp).concat(field, \":>=\").concat(granularity.iso8601(granularity.start(date)));\n\n      case Operator.LT:\n        return \"\".concat(matchOp).concat(field, \":<\").concat(granularity.iso8601(granularity.start(date)));\n\n      case Operator.LTE:\n        return \"\".concat(matchOp).concat(field, \":<\").concat(granularity.iso8601(granularity.startOfNext(date)));\n\n      default:\n        throw new Error(\"unknown operator [\".concat(operator, \"]\"));\n    }\n  }\n\n  return emitFieldDateLikeClause(field, date, operator, match);\n};\n\nvar emitFieldNumericClause = function emitFieldNumericClause(field, value, operator, match) {\n  var matchOp = emitMatch(match);\n\n  switch (operator) {\n    case Operator.EQ:\n      return \"\".concat(matchOp).concat(field, \":\").concat(value);\n\n    case Operator.GT:\n      return \"\".concat(matchOp).concat(field, \":>\").concat(value);\n\n    case Operator.GTE:\n      return \"\".concat(matchOp).concat(field, \":>=\").concat(value);\n\n    case Operator.LT:\n      return \"\".concat(matchOp).concat(field, \":<\").concat(value);\n\n    case Operator.LTE:\n      return \"\".concat(matchOp).concat(field, \":<=\").concat(value);\n\n    default:\n      throw new Error(\"unknown operator [\".concat(operator, \"]\"));\n  }\n};\n\nvar emitFieldStringClause = function emitFieldStringClause(field, value, match) {\n  var matchOp = emitMatch(match);\n\n  if (value.match(/\\s/)) {\n    return \"\".concat(matchOp).concat(field, \":\\\"\").concat(escapeValue(value), \"\\\"\");\n  }\n\n  return \"\".concat(matchOp).concat(field, \":\").concat(escapeValue(value));\n};\n\nvar emitFieldBooleanClause = function emitFieldBooleanClause(field, value, match) {\n  var matchOp = emitMatch(match);\n  return \"\".concat(matchOp).concat(field, \":\").concat(value);\n};\n\nvar emitFieldSingleValueClause = function emitFieldSingleValueClause(field, value, operator, match) {\n  if (isDateValue(value)) {\n    return emitFieldDateValueClause(field, value, operator, match);\n  }\n\n  if (isDateLike(value)) {\n    return emitFieldDateLikeClause(field, value, operator, match);\n  }\n\n  if (isString(value)) {\n    return emitFieldStringClause(field, value, match);\n  }\n\n  if (isNumber(value)) {\n    return emitFieldNumericClause(field, value, operator, match);\n  }\n\n  if (isBoolean(value)) {\n    return emitFieldBooleanClause(field, value, match);\n  }\n\n  throw new Error(\"unknown type of field value [\".concat(value, \"]\"));\n};\n\nvar emitFieldClause = function emitFieldClause(clause, isGroupMember) {\n  var field = clause.field,\n      value = clause.value,\n      operator = clause.operator;\n  var match = clause.match;\n\n  if (isGroupMember && AST.Match.isMust(match)) {\n    match = undefined;\n  }\n\n  if (!isArray(value)) {\n    return emitFieldSingleValueClause(field, value, operator, match);\n  }\n\n  var matchOp = emitMatch(match);\n  var clauses = value.map(function (v) {\n    return emitFieldSingleValueClause(field, v, operator);\n  }).join(' OR ');\n  return \"\".concat(matchOp, \"(\").concat(clauses, \")\");\n};\n\nvar emitTermClause = function emitTermClause(clause, isGroupMember) {\n  var value = clause.value;\n  var match = clause.match;\n\n  if (isGroupMember && AST.Match.isMust(match)) {\n    match = undefined;\n  }\n\n  var matchOp = emitMatch(match);\n  return \"\".concat(matchOp).concat(escapeValue(value));\n};\n\nvar emitIsClause = function emitIsClause(clause, isGroupMember) {\n  var flag = clause.flag,\n      match = clause.match;\n  var matchOp = isGroupMember ? '' : '+';\n  var flagValue = AST.Match.isMust(match);\n  return \"\".concat(matchOp).concat(flag, \":\").concat(flagValue);\n};\n\nvar emitGroupClause = function emitGroupClause(clause) {\n  var value = clause.value;\n  var formattedValues = value.map(function (clause) {\n    return emitClause(clause, true);\n  });\n  return \"+(\".concat(formattedValues.join(' '), \")\");\n};\n\nfunction emitClause(clause) {\n  var isGroupMember = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n  if (AST.Field.isInstance(clause)) {\n    return emitFieldClause(clause, isGroupMember);\n  }\n\n  if (AST.Term.isInstance(clause)) {\n    return emitTermClause(clause, isGroupMember);\n  }\n\n  if (AST.Is.isInstance(clause)) {\n    return emitIsClause(clause, isGroupMember);\n  }\n\n  if (AST.Group.isInstance(clause)) {\n    return emitGroupClause(clause);\n  }\n\n  throw new Error(\"unknown clause type [\".concat(JSON.stringify(clause), \"]\"));\n}\n\nexport var astToEsQueryString = function astToEsQueryString(ast) {\n  if (ast.clauses.length === 0) {\n    return '*';\n  }\n\n  return ast.clauses.map(function (clause) {\n    return emitClause(clause);\n  }).join(' ');\n};"]},"metadata":{},"sourceType":"module"}